<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>META_INSYT Database</title>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css"/>

<style>

body{
    margin:0;
    height:100vh;
    display:flex;
    justify-content:center;
    align-items:center;
    font-family:'Segoe UI',sans-serif;
    background: linear-gradient(135deg,#0f2027,#203a43,#2c5364);
    color:white;
}

.container{
    width:1000px;
    display:grid;
    grid-template-columns:1fr 1fr 1fr;
    gap:25px;
}

.card{
    background: rgba(255,255,255,0.08);
    backdrop-filter: blur(12px);
    border-radius:15px;
    padding:30px;
    box-shadow:0 10px 30px rgba(0,0,0,0.4);
    animation:fadeUp 0.7s ease;
}

h1{
    position:absolute;
    top:30px;
    text-align:center;
    width:100%;
}

h2{
    text-align:center;
}

input{
    width:100%;
    padding:12px;
    border-radius:8px;
    border:none;
    margin-top:10px;
}

button{
    margin-top:15px;
    width:100%;
    padding:12px;
    border:none;
    border-radius:8px;
    background:linear-gradient(45deg,#00c6ff,#0072ff);
    color:white;
    cursor:pointer;
}

@keyframes fadeUp{
    from{opacity:0;transform:translateY(20px);}
    to{opacity:1;transform:translateY(0);}
}

</style>
</head>

<body>

<h1>üöÄ META_INSYT Database Management System(upload csv with email and name header)</h1>

<div class="container">

<!-- ================= UPLOAD SECTION ================= -->
<div class="card">
<h2>üì§ Upload Verified Emails</h2>

<form id="uploadForm">
<input type="file" name="emailList" accept=".csv" required>
<button type="submit">Upload CSV</button>
</form>
</div>


<!-- ================= DOWNLOAD SECTION ================= -->
<div class="card">
<h2>üì• Download Emails</h2>

<form action="/download-all" method="get">
<button type="submit">‚¨á Full Database Download</button>
</form>

<hr style="margin:20px 0;opacity:0.3">

<form action="/download-domain" method="get">
<input type="text" name="domain" placeholder="example.com" required>
<button type="submit">‚¨á Download Domain Emails</button>
</form>
</div>


<!-- ================= REMOVE INVALID CSV ================= -->
<div class="card">
<h2>üßπ Remove Emails via CSV</h2>

<form id="removeForm">
<input type="file" name="emailList" accept=".csv" required>
<button type="submit">Remove Emails From DB</button>
</form>
</div>

</div>


<script src="https://cdn.jsdelivr.net/npm/toastify-js"></script>

<script>

// =======================
// UPLOAD CSV
// =======================
document.getElementById("uploadForm").addEventListener("submit", async function(e){

    e.preventDefault();

    const formData = new FormData(this);

    try{

        const res = await fetch("/upload",{method:"POST",body:formData});
        const data = await res.json();

        Toastify({
            text:`‚úÖ Created: ${data.created} | ‚ö†Ô∏è Duplicates: ${data.duplicates}`,
            duration:4000,
            gravity:"top",
            position:"right",
            style:{background:"linear-gradient(to right,#00b09b,#96c93d)"}
        }).showToast();

    }catch{
        Toastify({
            text:"‚ùå Upload Failed",
            duration:4000,
            style:{background:"red"}
        }).showToast();
    }

});


// =======================
// REMOVE EMAILS CSV
// =======================
document.getElementById("removeForm").addEventListener("submit", async function(e){

    e.preventDefault();

    const formData = new FormData(this);

    try{

        const res = await fetch("/remove-invalid-csv",{method:"POST",body:formData});
        const data = await res.json();

        Toastify({
            text:`üßπ Removed ${data.deletedCount} emails from DB`,
            duration:4000,
            gravity:"top",
            position:"right",
            style:{background:"linear-gradient(to right,#ff416c,#ff4b2b)"}
        }).showToast();

    }catch{
        Toastify({
            text:"‚ùå Remove Failed",
            duration:4000,
            style:{background:"red"}
        }).showToast();
    }

});

</script>

</body>
</html>

